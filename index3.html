<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API</title>
    <!-- <link rel="stylesheet" href="api.css"> -->
    <style>
        .body {
            margin: 0;
            padding: 0;
        }

        .row {
            width: 200px;
            background: #fe4164;
            border-radius: 30px;
        }

        .container1 {
            display: flex;
            justify-content: flex-start;
        }
        .container{
            display: flex;
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>

<body>

    <div class="body">
        <div class="container">
            <div class="col" id="source"></div>
            <div class="col" id="result"></div>
        </div>
    </div>

    <script>
        
        const API_USERS = 'https://jsonplaceholder.typicode.com/users';
        const API_USERS_ID = 'https://jsonplaceholder.typicode.com/todos?userId=';

class ApplicationProgrammingInterface
{
    constructor(sourceid = 'source', resultid = 'result')
    {
        this.source = document.querySelector(`#${sourceid}`);
        this.result = document.querySelector(`#${resultid}`);

    }

    getUsers()
    {
        fetch(API_USERS)
        .then(response => response.json())
        .then(json => this.renderUsers(json))
    }



    getUsersTodo(id)
    {
        fetch('https://jsonplaceholder.typicode.com/todos?userId='+id)
        .then(response => response.json())
        .then(json => this.findUsers(json))
    }

    renderUsers(users) {
    let template = '<table class="table table-dark table-striped-columns">';
    users.forEach(item => {
        template += `
        <tr>
            <td>${item.id}</td>
            <td>${item.name}</td>
            <td>${item.username}</td>
            <td>${item.email}</td>
            <td>${item.phone}</td>
            <td><button class="btn btn-primary" data-id="${item.id}">Click me</button></td>
        </tr>
        `;
    });
    template += '</table>';
    this.source.innerHTML = template;

    // Добавляем обработчик события на таблицу для обработки кликов на кнопках
    this.source.addEventListener('click', (event) => {
        if (event.target.classList.contains('btn')) {
            // Получаем id элемента, на который был совершен клик
            const userId = event.target.getAttribute('data-id');
        
            api.getUsersTodo(userId);
        }
    });
}

    findUsers(users)
    {
        let template = '<table class="table table-dark table-striped-columns">';
        console.log(users);
        users.forEach(item => {
            template += `
            <tr class="table-success">
                <td>${item.userId}</td>
                <td>${item.id}</td>
                <td>${item.title}</td>
                <td>${item.completed}</td>
            </tr>
            `
        });
        template += '</table>';
        this.result.innerHTML = template;
    }
}

const api = new ApplicationProgrammingInterface();
api.getUsers();


    </script>
    <!-- <script src="api.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
</body>

</html>